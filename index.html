<!DOCTYPE html>
<html lang="pt=br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<body class="bg-primary-subtle text-emphasis-primary p-2">
    <h1 class="text-center m-3">Formulario</h1>
    <div class="container needs-validation" novalidate>
        <div class="row p-2">
            <div class="col">
                <input type="text" class="form-control" placeholder="nome" aria-label="First name" id="nome" required>
            </div>
            <div class="col">
                <input type="text" class="form-control" placeholder="sobrenome" aria-label="Last name" id="sobrenome" required>
            </div>

            <div class="col">
                <input type="text" class="form-control" placeholder="CPF" aria-label="Zip" maxlength="11" minlength="11" id="cpf">
            </div>
        </div>
        <div class="ms-2">
            <h6 class="p-2">Sexo</h6>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="RadioOptions" id="myRadio" value="option1">
                <label class="form-check-label" for="myRadio">Masculino</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="RadioOptions" id="myRadio2" value="option2">
                <label class="form-check-label" for="myRadio2">Feminino</label>
            </div>
        </div>
        <div class="ms-2">
            <h6 class="p-2">Faixa etária</h6>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="inlineRadioOptions" id="bebe" value="option3">
                <label class="form-check-label" for="bebe">0-5</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="inlineRadioOptions" id="crianca" value="option4">
                <label class="form-check-label" for="crianca">6-12</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="inlineRadioOptions" id="adolecente" value="option5">
                <label class="form-check-label" for="adolecente">13-18</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="inlineRadioOptions" id="adulto" value="option6">
                <label class="form-check-label" for="adulto">19-60</label>
            </div>
            <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="inlineRadioOptions" id="idoso" value="option7">
                <label class="form-check-label" for="idoso">61-100</label>
            </div>
        </div>
        <div class="row p-2">
            <div class="col-md-6 mt-4">
                <input type="email" class="form-control" placeholder="Email" id="inputEmail4" required>
            </div>
            <div class="col mt-4">
                <input type="text" class="form-control" id="inputAddress" placeholder="Bairro" required>
            </div>
            <div class="col-12 mt-4">
                <input type="text" class="form-control" placeholder="Endereço"   id="inputAddress2" placeholder="Apartment, studio, or floor" required>
            </div>
            <div class="col-md-6 mt-4">
                <input type="text" class="form-control" placeholder="Cidade"  id="inputCity" required>
            </div>
            <div class="col-md-6 mt-4">
                <input type="text" class="form-control" placeholder="Estado"  id="inputEstado" required>
            </div>
            <div class="col-6 mt-4">
                <input type="text" class="form-control" placeholder="CEP" id="inputZip" maxlength="8" minlength="8">
            </div>
            <select class="form-select col mt-4" aria-label="Default select example"  id="lista-conteudos">
                <option></option>
                <option id="branco" value="1">Branco</option>
                <option id="amarelo" value="2">Amarelo</option>
                <option id="negro" value="3">Negro</option>
                <option id="indio" value="4">Indio</option>
            </select>
        </div>
        <div class="col p-2">
            <button onclick="myFunction()" class="btn btn-primary">Enviar</button>
            <button onclick="mostrarCadastros()" class="btn btn-primary">Mostrar Cadastros</button>
            <button onclick="excluirCadastro()" class="btn btn-danger">Excluir Cadastro</button>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <canvas id="pieChart"></canvas>
        </div>
        <div class="col">
            <canvas id="pieChart2"></canvas>
        </div>
        <div class="col">
            <canvas id="pieChart3"></canvas>
        </div>
    </div>  

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="grafico.js"></script>
    <script>
        // Arrays para armazenar os cadastros e IDs para controle
        var cadastros = [];
        var proximoId = 1;

        // Seus contadores permanecem os mesmos
        
        async function myFunction() {
            // Código para obter os dados do formulário
            var nome = document.getElementById("nome").value;
            var sobrenome = document.getElementById("sobrenome").value;
            var cpf = document.getElementById("cpf").value;
            var email = document.getElementById("inputEmail4").value = "";
            var bairro = document.getElementById("inputAddress").value = "";
            var endereco = document.getElementById("inputAddress2").value = "";
            var cidade = document.getElementById("inputCity").value = "";
            var estado = document.getElementById("inputEstado").value = "";
            var cep = document.getElementById("inputZip").value;
            // Adicione mais campos conforme necessário

             // Adicionando a validação do CPF
            if (!validarCPF(cpf)) {
                alert('CPF inválido. Por favor, digite um CPF válido.');
                return;
            }

            // Adicionando a validação do CEP
            if (!validarCEP(cep)) {
                alert('CEP inválido. Por favor, digite um CEP válido.');
                return;
            }

            // Criação de um objeto de cadastro com ID único
            var cadastro = {
                id: proximoId++,
                nome: nome,
                sobrenome: sobrenome,
                cpf: cpf,
                email: email,
                bairro: bairro,
                endereco: endereco,
                cidade: cidade,
                estado, estado,
                cep: cep
                // Adicione mais campos conforme necessário
            };

            // Adiciona o cadastro ao array
            cadastros.push(cadastro);

            // Limpa os campos do formulário após o cadastro
            document.getElementById("nome").value = "";
            document.getElementById("sobrenome").value = "";
            document.getElementById("cpf").value = "";
            document.getElementById("inputEmail4").value = "";
            document.getElementById("inputAddress").value = "";
            document.getElementById("inputAddress2").value = "";
            document.getElementById("inputCity").value = "";
            document.getElementById("inputEstado").value = "";
            document.getElementById("inputZip").value = "";
            // Limpe mais campos conforme necessário
            myFunction2()
        }

        function validarCampos() {
            // Campos que você deseja validar
            var campos = ["nome", "sobrenome", "cpf"];

            // Verificar se todos os campos estão preenchidos
            for (var i = 0; i < campos.length; i++) {
                var valorCampo = document.getElementById(campos[i]).value;
                if (valorCampo.trim() === "") {
                    alert("Preencha todos os campos obrigatórios.");
                    return;
                }
            }

            // Se todos os campos estiverem preenchidos, continue com a lógica desejada
            // ...

            // No caso, chame a função myFunction para adicionar o cadastro
            myFunction();
        }

        // Função para validar CPF
        function validarCPF(cpf) {
            // Implementação da validação de CPF
            cpf = cpf.replace(/[^\d]+/g,'');
            if(cpf == '') return false; 
            if (cpf.length !== 11 || /^(.)\1+$/.test(cpf)) return false;
            var resto;
            var soma = 0;

            for (var i = 1; i <= 9; i++) soma = soma + parseInt(cpf.substring(i - 1, i)) * (11 - i);
            resto = (soma * 10) % 11;

            if (resto == 10 || resto == 11) resto = 0;
            if (resto != parseInt(cpf.substring(9, 10))) return false;

            soma = 0;
            for (var i = 1; i <= 10; i++) soma = soma + parseInt(cpf.substring(i - 1, i)) * (12 - i);
            resto = (soma * 10) % 11;

            if (resto == 10 || resto == 11) resto = 0;
            if (resto != parseInt(cpf.substring(10, 11))) return false;
            return true;
        }

        // Função para validar CEP
        function validarCEP(cep) {
            // Implementação da validação de CEP
            cep = cep.replace(/\D/g, '');
            return cep.length === 8;
        }

        function mostrarCadastros() {
            // Mostra os cadastros em um alerta
            var cadastrosStr = "Lista de Cadastros:\n";
            cadastros.forEach(function(cadastro) {
                cadastrosStr += `ID: ${cadastro.id}, Nome: ${cadastro.nome}, Sobrenome: ${cadastro.sobrenome}, CPF: ${cadastro.cpf}, CEP: ${cadastro.cep}\n`;
            });
            alert(cadastrosStr);
        }


        function excluirCadastro() {
            // Solicita o ID do cadastro a ser excluído
            var idExcluir = prompt("Digite o ID do cadastro a ser excluído:");

            // Converte o ID para número
            idExcluir = parseInt(idExcluir);

            // Verifica se o ID é válido e exclui o cadastro correspondente
            if (!isNaN(idExcluir)) {
                cadastros = cadastros.filter(function(cadastro) {
                    return cadastro.id !== idExcluir;
                });
                alert(`Cadastro com ID ${idExcluir} excluído.`);
            } else {
                alert("ID inválido. Exclusão cancelada.");
            }
        }
    </script>
</body>
</html>
